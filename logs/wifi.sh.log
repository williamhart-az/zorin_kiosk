2025-05-20 16:21:47 - Starting wifi.sh script. Path: /home/alocalbox/zorin_kiosk/features/wifi.sh, Current directory: /home/alocalbox/zorin_kiosk
2025-05-20 16:21:47 - Error handling enabled with 'set -e'
2025-05-20 16:21:47 - Checking if script is running as root
2025-05-20 16:21:47 - Script is running as root, continuing
2025-05-20 16:21:47 - Checking for environment file
2025-05-20 16:21:47 - ENV_FILE not defined, using default: features/../.env
2025-05-20 16:21:47 - Checking if environment file exists at: features/../.env
2025-05-20 16:21:47 - Sourcing environment file: features/../.env
2025-05-20 16:21:47 - Environment file sourced successfully. WIFI_SSID=LAT-Staff
2025-05-20 16:21:47 - Feature: Restricting network settings access
2025-05-20 16:21:47 - Checking if dconf is installed
2025-05-20 16:21:47 - dconf is available.
2025-05-20 16:21:47 - Creating dconf profile directory /etc/dconf/profile/...
2025-05-20 16:21:47 - Writing user profile configuration to /etc/dconf/profile/user...
2025-05-20 16:21:47 - Creating dconf database directory /etc/dconf/db/local.d/...
2025-05-20 16:21:47 - Creating network settings restrictions file /etc/dconf/db/local.d/00-network...
2025-05-20 16:21:47 - Network settings restrictions file created.
2025-05-20 16:21:47 - Creating dconf locks directory /etc/dconf/db/local.d/locks/...
2025-05-20 16:21:47 - Creating network settings locks file /etc/dconf/db/local.d/locks/network...
2025-05-20 16:21:47 - Network settings locks file created.
2025-05-20 16:21:47 - Updating dconf database...
2025-05-20 16:21:47 - Network settings restrictions applied successfully.
2025-05-20 16:21:47 - Feature: WiFi Configuration
2025-05-20 16:21:47 - Checking WiFi configuration settings...
2025-05-20 16:21:47 - Ensuring required WiFi packages are installed
2025-05-20 16:21:47 - Installing missing packages: iw net-tools
2025-05-20 16:21:51 - Package installation attempt completed.
2025-05-20 16:21:51 - Checking if WiFi credentials are provided in environment file (WIFI_SSID and WIFI_PASSWORD)...
2025-05-20 16:21:51 - WiFi credentials found. SSID: LAT-Staff
2025-05-20 16:21:51 - Creating/ensuring persistent WiFi connection file for 'LAT-Staff'...
2025-05-20 16:21:51 - Creating persistent WiFi connection for SSID: LAT-Staff
2025-05-20 16:21:51 - Detecting security type for SSID: LAT-Staff
2025-05-20 16:21:51 - Rescanning for WiFi networks to detect security for LAT-Staff...
2025-05-20 16:21:53 - Detected security string for 'LAT-Staff': WPA2
2025-05-20 16:21:53 - Interpreted security type as WPA2 for 'LAT-Staff'.
2025-05-20 16:21:53 - Using detected security type: WPA2 for SSID: LAT-Staff
2025-05-20 16:21:53 - Ensuring NetworkManager system connections directory exists: /etc/NetworkManager/system-connections/
2025-05-20 16:21:53 - Generated UUID for persistent connection 'LAT-Staff': 39507f6a-0a20-4bee-bde6-5668f043a1d5
2025-05-20 16:21:53 - Using WiFi interface: wlo1 for persistent connection 'LAT-Staff'.
2025-05-20 16:21:53 - Creating connection file at /etc/NetworkManager/system-connections/LAT-Staff.nmconnection for persistent connection 'LAT-Staff'.
2025-05-20 16:21:53 - Applying security settings for type: WPA2 to /etc/NetworkManager/system-connections/LAT-Staff.nmconnection
2025-05-20 16:21:53 - Applied WPA/WPA2 PSK security settings for 'LAT-Staff'.
2025-05-20 16:21:53 - Setting permissions for connection file /etc/NetworkManager/system-connections/LAT-Staff.nmconnection to 600...
2025-05-20 16:21:53 - Reloading NetworkManager connections (nmcli connection reload)...
2025-05-20 16:21:53 - Persistent WiFi connection file for 'LAT-Staff' created at /etc/NetworkManager/system-connections/LAT-Staff.nmconnection.
2025-05-20 16:21:53 - Calling main WiFi configuration function for 'LAT-Staff'...
2025-05-20 16:21:53 - Configuring WiFi connection for SSID: LAT-Staff
2025-05-20 16:21:53 - Checking if NetworkManager (nmcli) is installed
2025-05-20 16:21:53 - NetworkManager (nmcli) found, proceeding with configuration.
2025-05-20 16:21:53 - Getting WiFi interface name...
2025-05-20 16:21:53 - Found WiFi interface: wlo1
2025-05-20 16:21:53 - Ensuring WiFi is enabled via nmcli radio wifi on...
2025-05-20 16:21:53 - Scanning for WiFi networks (nmcli device wifi rescan)...
2025-05-20 16:21:55 - Checking if connection 'LAT-Staff' already exists...
2025-05-20 16:21:55 - WiFi connection for 'LAT-Staff' already exists, deleting it first...
2025-05-20 16:21:55 - Existing connection 'LAT-Staff' deleted.
2025-05-20 16:21:55 - Creating new WiFi connection for 'LAT-Staff' using nmconnection file...
2025-05-20 16:21:55 - Generated UUID for connection: 9be6eeca-a142-4815-83ec-2604937e6e54
2025-05-20 16:21:55 - Creating connection file at /etc/NetworkManager/system-connections/LAT-Staff.nmconnection
2025-05-20 16:21:55 - Setting permissions for connection file /etc/NetworkManager/system-connections/LAT-Staff.nmconnection to 600...
2025-05-20 16:21:55 - Reloading NetworkManager connections (nmcli connection reload)...
2025-05-20 16:21:55 - Activating the WiFi connection 'LAT-Staff' (nmcli connection up)...
2025-05-20 16:21:58 - Successfully activated connection 'LAT-Staff' using 'nmcli connection up'.
2025-05-20 16:21:58 - Verifying connection status for 'LAT-Staff'...
2025-05-20 16:21:58 - WiFi connection 'LAT-Staff' successfully activated.
2025-05-20 16:21:58 - Setting connection 'LAT-Staff' to autoconnect yes...
2025-05-20 16:21:58 - Making connection 'LAT-Staff' available to all users (permissions='')...
2025-05-20 16:21:58 - WiFi configuration for 'LAT-Staff' completed.
2025-05-20 16:21:58 - WiFi configuration function completed with status: 0 for 'LAT-Staff'.
2025-05-20 16:21:58 - Verifying WiFi connection for 'LAT-Staff' after configuration attempt...
2025-05-20 16:21:58 - Verifying WiFi connection to SSID: LAT-Staff
2025-05-20 16:22:01 - Connection to 'LAT-Staff' is active.
2025-05-20 16:22:01 - Testing internet connectivity by pinging 8.8.8.8...
2025-05-20 16:22:01 - Internet connectivity verified for 'LAT-Staff'.
2025-05-20 16:22:01 - WiFi connection to 'LAT-Staff' successfully verified.
2025-05-20 16:22:01 - WiFi setup script (wifi.sh) completed.
